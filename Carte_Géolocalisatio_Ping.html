<!DOCTYPE html>
<html>
<body>

<h2>JavaScript Geolocation API</h2>
<p>Click the button to get your coordinates.</p>

<button onclick="getLocation()">Try It</button>

<p id="error"></p>
<div id="mapholder" style="height: 400px;"></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

<script>
  // partie de code qui permet de mettre paris par défaut sur la carte
var map = L.map('mapholder').setView([48.866667, 2.333333], 13);

// partie de code qui permet de mettre la carte openstreetmap sur la carte
L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
}).addTo(map);

//partie de code qui permet de récupérer la position de l'utilisateur
function getLocation() {
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(showPosition);
  } else { 
    document.getElementById("error").innerHTML = "La géolocalisation n'est pas prise en charge par ce navigateur. "<br> "Geolocation is not supported by this browser.";
  }
}

//partie de code qui permet d'afficher la position de l'utilisateur
function showPosition(position) {
  map.setView([position.coords.latitude, position.coords.longitude], 13); // Update the position of the map
  L.marker([position.coords.latitude, position.coords.longitude]).addTo(map);
}


// partie de code qui permet de mettre un ping sur la carte
// partie de code qui permet de modifier l'image 
var pingIcon = L.icon({
    iconUrl: 'img/ping.png',
    iconSize:     [30, 50], // size of the icon
    shadowSize:   [50, 64], // size of the shadow
    iconAnchor:   [22, 94], // point of the icon which will correspond to marker's location
    shadowAnchor: [4, 62],  // the same for the shadow
    popupAnchor:  [-3, -76] // point from which the popup should open relative to the iconAnchor
});

// partie de code qui permet de donner la position du ping
var marker = L.marker([48.866667, 2.333333], {icon: pingIcon}).addTo(map);

// partie de code qui permet de modifier la taille du ping en fonction du zoom
map.on('zoomend', function() {
    var currentZoom = map.getZoom();
    pingIcon.options.iconSize = [30 * currentZoom / 20, 50 * currentZoom / 20]; // ajuster la taille de l'icône en fonction du niveau de zoom actuel
    pingIcon.options.iconAnchor = [14 * currentZoom / 20, 49 * currentZoom / 20]; // ajuster lacroche de l'icône en fonction du niveau de zoom actuel
    marker.setIcon(pingIcon);
});

</script>

</body>
</html>